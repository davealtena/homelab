---
apiVersion: "cilium.io/v2"
kind: CiliumNetworkPolicy
metadata:
  name: internal-network-access
spec:
  # Targets endpoints (pods) with specific label
  endpointSelector:
    matchLabels:
      # Same label used in Gateway's namespace selector
      network-scope: internal

  # Ingress rules define incoming traffic allowed
  ingress:
    - fromCIDR:
        # Explicitly allow traffic from your internal network CIDR
        - 192.168.2.0/24
    - fromEntities:
        # Allow traffic from within the cluster
        - cluster

  # Egress rules define outgoing traffic allowed
  egress:
    - toEntities:
        # Allow outbound traffic to cluster resources
        - cluster
    - toCIDR:
        # Optionally restrict outbound traffic to internal network
        - 192.168.2.0/24
